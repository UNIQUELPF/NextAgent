{
  "$id": "https://next-agent-portal/schemas/identity.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "phone": {
      "type": "string",
      "pattern": "^\\+?[1-9]\\d{7,14}$",
      "description": "E.164 formatted phone number used as primary credential."
    },
    "user_type": {
      "type": "string",
      "enum": [
        "external",
        "internal",
        "tenant"
      ]
    },
    "tenant_id": {
      "type": "string",
      "minLength": 1
    },
    "roles": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9:_-]{3,64}$"
      },
      "uniqueItems": true
    }
  },
  "required": [
    "phone",
    "user_type"
  ]
}
